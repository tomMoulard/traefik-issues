FROM golang:1.15-alpine as builder

WORKDIR /go/whoami

COPY app.go .

RUN CGO_ENABLED=0 go build -a --trimpath --installsuffix cgo --ldflags="-s" -o whoami

# Create a minimal container to run a Golang static binary
FROM scratch

COPY --from=builder /go/whoami/whoami .

ENTRYPOINT ["/whoami"]
EXPOSE 8080
